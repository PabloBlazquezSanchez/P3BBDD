Public Class IU_VentanaPrincipal


    Private pais As Pais
    Private rol As Roles

    Private generoPeli As Generos
    Private generoTodo As Generos
    Private roledi As Roles

    Private peliculaParti As ClasificacionCarrera
    Private rolPart As Roles

    Private peliAñadida As ClasificacionCarrera
    Private rolAñadido As Roles

    
    
    Private estadoRoles As Integer
    Private estadoPaises As Integer
    Private estadoAñadirGenero As Integer
    Private estadoEliminarGenero As Integer
    Private rutaEjecutable As String

    Private estadoPartiPeli As Integer
    Private estadoPartiRol As Integer
    Private estadoCheckAñadir As Integer



    Private Sub llenarComboBoxPaises(ByVal cbPaises As ComboBox)
        Dim objDic As New Dictionary(Of String, String)()

        For Each ObjCultureInfo As System.Globalization.CultureInfo In System.Globalization.CultureInfo.GetCultures(System.Globalization.CultureTypes.SpecificCultures)
            Dim objRegionInfo As New System.Globalization.RegionInfo(ObjCultureInfo.Name)
            If Not objDic.ContainsKey(objRegionInfo.DisplayName) Then
                objDic.Add(objRegionInfo.DisplayName, objRegionInfo.TwoLetterISORegionName.ToLower())
            End If
        Next

        Dim obj = objDic.OrderBy(Function(p) p.Key)

        For Each val As KeyValuePair(Of String, String) In obj
            cbPaises.Items.Add(val.Key)
        Next
    End Sub



    Private Sub Bt_Anadir(sender As Object, e As EventArgs) Handles BtAñadirPer.Click
        estadoPiloto = 0
        ModoEditarAñadirPil(True)
        CheckBoxAñadirTrabajo.Enabled = False
    End Sub

    Private Sub BtAñadirCir_Click(sender As Object, e As EventArgs) Handles BtAñadirCir.Click
        estadoCircuito = 0
        Dim pais As Pais
        pais = New Pais
        pais.leertodo()
        ListBoxGenerosAñadidos.Items.Clear()
        ListBoxPilotos.SelectedItem = Nothing

        ModoEditarAñadirCir(True)


    End Sub



    Private Sub BtLimpiarRoles_Click(sender As Object, e As EventArgs)
        TextBoxDescRol.Text = ""

    End Sub

    Private Sub generarFichaPersona(persona As Personas)

        ListBoxParticipaciones.Items.Clear()
        TextBoxNombre1.Text = persona.nombre & " " & persona.apellido
        TextBoxFechaNac1.Text = persona.fechaDeNacimiento
        TextBoxLugarNac1.Text = persona.ciudadDeNacimiento & ", " & persona.paisDeNacimiento
        TextBoxNacionalidad1.Text = persona.nacionalidad

        persona.leerParticipaciones()

        For Each parti In persona.participaciones

            Dim split As String() = parti.ToString().Split(New [Char]() {" "c})
            Dim idPelicula As Integer
            Dim idRol As Integer
            idPelicula = CInt(split(0))
            idRol = CInt(split(1))

            Dim peliculaP As ClasificacionCarrera
            peliculaP = New ClasificacionCarrera
            Dim rolP As Roles
            rolP = New Roles

            peliculaP.idPelicula = idPelicula
            rolP.idRol = idRol
            peliculaP.leer()
            rolP.leer()

            ListBoxParticipaciones.Items.Add(peliculaP.titulo & " --- " & rolP.descRol)
        Next

    End Sub
    Private Sub CheckBoxPersonas_CheckedChnged(sender As Object, e As EventArgs) Handles CheckBoxFichaPersonas.CheckedChanged
        If ListBoxPilotos.SelectedItem IsNot Nothing Then
            GBFichaPiloto.Visible = CheckBoxFichaPersonas.Checked

        End If
    End Sub


    Private Sub ListBoxCircuitos_SelectedIndexChanged(sender As Object, e As EventArgs) Handles ListBoxCircuitos.SelectedIndexChanged
        If ListBoxCircuitos.SelectedItem IsNot Nothing Then
            BtEditCir.Enabled = True
            BtElimCir.Enabled = True

            Dim split As String() = ListBoxCircuitos.SelectedItem.ToString().Split(New [Char]() {" "c})
            Dim id As Integer
            id = CInt(split(0))
            Dim circuitos As ClasificacionCarrera
            circuitos = New ClasificacionCarrera

            circuitos.IdCircuito = id
            circuitos.LeerCircuito()

            Me.circuito = circuitos

        Else
            BtEditCir.Enabled = False
            BtElimCir.Enabled = False
        End If

    End Sub


    Private Sub ListBoxPersonas_SelectedIndexChanged(sender As Object, e As EventArgs) Handles ListBoxPilotos.SelectedIndexChanged
        ListBoxEditarParticipaciones.Items.Clear()
        If ListBoxPilotos.SelectedItem IsNot Nothing Then
            BtEditarPer.Enabled = True
            BtEliminarPer.Enabled = True
            CheckBoxFichaPersonas.Enabled = True
            Dim split As String() = ListBoxPilotos.SelectedItem.ToString().Split(New [Char]() {" "c})
            Dim id As Integer
            id = CInt(split(0))

            Dim persona As Personas

            persona = New Personas
            persona.idPersona = id
            persona.leer()
            Me.piloto = persona
            generarFichaPersona(persona)
            estadoCheckAñadir = 0
        Else
            BtEditarPer.Enabled = False
            BtEliminarPer.Enabled = False
            GBFichaPiloto.Visible = False
            CheckBoxFichaPersonas.Enabled = False

        End If

    End Sub

    Private Sub ListBoxGenero_SelectedIndexChanged(sender As Object, e As EventArgs) Handles ListBoxPaises.SelectedIndexChanged
        If ListBoxPaises.SelectedItem IsNot Nothing Then
            BtEditarPais.Enabled = True
            BtBorrarPais.Enabled = True
            BtAñadirPais.Enabled = True
            Dim split As String() = ListBoxPaises.SelectedItem.ToString().Split(New [Char]() {" "c})
            Dim id As Integer
            id = CInt(split(0))

            Dim pais As Pais
            pais = New Pais

            pais.idPAIS = id
            pais.LeerPais()

            Me.pais = pais
        Else
            BtEditarPais.Enabled = False
            BtBorrarPais.Enabled = False
        End If
    End Sub

    Private Sub BtAñadirGenero_Click(sender As Object, e As EventArgs) Handles BtAñadirPais.Click
        Me.estadoPaises = 0
        GBEditarAñadirPais.Enabled = True
        TextBoxDescPais.Text = " "

        BtAñadirPais.Enabled = False


    End Sub

    Private Sub ListBoxRoles_SelectedIndexChanged(sender As Object, e As EventArgs) Handles ListBoxRoles.SelectedIndexChanged
        If ListBoxRoles.SelectedItem IsNot Nothing Then
            BtAñadirRol.Enabled = True
            BtEditarConf.Enabled = True
            BtBorrarRol.Enabled = True
            Dim split As String() = ListBoxRoles.SelectedItem.ToString().Split(New [Char]() {" "c})
            Dim id As Integer
            id = CInt(split(0))

            Dim rol As Roles
            rol = New Roles

            rol.idRol = id
            rol.leer()
            Me.rol = rol
            Me.roledi = rol

        Else
            BtAñadirRol.Enabled = False
            BtEditarConf.Enabled = False

        End If

    End Sub

    Private Sub BtAñadirRol_Click(sender As Object, e As EventArgs) Handles BtAñadirRol.Click
        Me.estadoRoles = 0
        GBEditarRoles.Enabled = True
        TextBoxDescRol.Text = " "
        BtAñadirRol.Enabled = False
    End Sub


    Private Sub BtGuardarPel_Click(sender As Object, e As EventArgs) Handles BtGuardarCir.Click

        If (comprobarCamposCircuito()) Then
            Dim titulo As String
            Dim tituloOriginal As String
            Dim añoEstreno As Integer
            Dim duracion As Integer
            Dim sinopsis As String
            Dim cartelPelicula As String

            titulo = TextBoxNombreCircuito.Text().Trim()
            tituloOriginal = TextBoxCiudadCircuito.Text().Trim()
            añoEstreno = NumericAño2.Value()
            duracion = NumericDuracion2.Value()
            sinopsis = TextBoxSinopsis2.Text().Trim()
            sinopsis = sinopsis.Substring(0, 1).ToUpper + sinopsis.Substring(1, sinopsis.Length - 1).ToLower


            If (Me.estadoCircuito = 0) Then 'Se ha pulsado el boton guardar añadiendo un nuevo circuitoa'

                circuito = New Circuito(titulo, tituloOriginal, añoEstreno, duracion, sinopsis, cartelPelicula)

                Try
                    circuito.insertar()
                    circuito.leerID()
                    ListBoxCircuitos.Items.Add(circuito.idPelicula & "  " & circuito.titulo)
                    For Each Item As Object In ListBoxGenerosAñadidos.Items

                        Dim split As String() = Item.ToString().Split(New [Char]() {" "c})
                        Dim idGenero As Integer
                        idGenero = CInt(split(0))
                        Dim genero As Generos
                        genero = New Generos
                        genero.idGenero = idGenero
                        genero.leer()

                        circuito.insertarGenero(genero)

                    Next
                    MessageBox.Show("Se ha añadido a la base de datos  " & titulo)
                    ModoEditarAñadirCir(False)
                Catch ex As Exception
                    MessageBox.Show(ex.Message, ex.Source)
                End Try
            End If

            If (Me.estadoCircuito = 1) Then 'Se ha pulsado el boton guardar editando una pelicula existente'
                Dim id As Integer
                id = circuito.idPelicula

                Try
                    circuito = New Circuito(titulo, tituloOriginal, añoEstreno, duracion, sinopsis, cartelPelicula)
                    circuito.idPelicula = id
                    circuito.eliminarGeneros()

                    For Each Item As Object In ListBoxGenerosAñadidos.Items

                        Dim split As String() = Item.ToString().Split(New [Char]() {" "c})
                        Dim idGenero As Integer
                        idGenero = CInt(split(0))
                        Dim genero As Generos
                        genero = New Generos
                        genero.idGenero = idGenero
                        genero.leer()

                        circuito.insertarGenero(genero)

                    Next
                    Dim actualizar As Integer
                    actualizar = circuito.modificar()
                    If (actualizar = 0) Then
                        MessageBox.Show("Error. No se ha podido modificar")
                    Else
                        MessageBox.Show("Película modificada con exito")
                    End If
                    Dim indice As Integer
                    indice = ListBoxCircuitos.SelectedIndex
                    ListBoxCircuitos.Items.RemoveAt(indice)
                    ListBoxCircuitos.Items.Insert(indice, circuito.idPelicula & "   " & circuito.titulo)
                Catch ex As Exception
                    MessageBox.Show("ERROR")
                End Try

            End If

            ModoEditarAñadirCir(False)

        End If

    End Sub

  



 


    Private Sub BtAñadir_Click(sender As Object, e As EventArgs) Handles BtAñadirPartipacion.Click
        If estadoPartiPeli = 1 And estadoPartiRol = 1 Then
            Try

                piloto.insertarParticipacion(peliculaParti, rolPart)
                ListBoxEditarParticipaciones.Items.Add(peliculaParti.idPelicula & " " & peliculaParti.titulo & " --- " & rolPart.idRol & " " & rolPart.descRol)
                ListBoxCircuitos.SelectedItem = Nothing
                estadoPartiPeli = 0
                estadoPartiRol = 0
                CBPeliculaAñadirParti.SelectedIndex = -1
                CBoxRolAñadirParti.SelectedIndex = -1
            Catch
                MessageBox.Show("No se puede añadir puesto que ya esta en la base de datos")
            End Try
        Else
            MessageBox.Show("Seleccione una pelicula y su rol ")
        End If
    End Sub



    Private Sub BtGuardarPer_Click(sender As Object, e As EventArgs) Handles BtGuardarPiloto.Click

        If comprobarCamposPil() Then
            Dim Nombre As String
            Dim ID As String
            Dim fechaNacimiento As String
            Dim paisNacimiento As String

            Nombre = TextBoxNombrePiloto.Text().Trim()
            Nombre = Nombre.Substring(0, 1).ToUpper + Nombre.Substring(1, Nombre.Length - 1).ToLower
            fechaNacimiento = DateTimeNacimiento2.Value.ToShortDateString().ToString()
            ID = TextBoxIDPiloto.Text.Trim()
            paisNacimiento = CBPaisPiloto.SelectedItem.ToString()


            If (Me.estadoPiloto = 0) Then
                piloto = New Piloto(Nombre, fechaNacimiento, ID, paisNacimiento)

                Try
                    piloto.insertar()
                    piloto.leerID()
                    ListBoxPilotos.Items.Add(piloto.idPersona & "  " & piloto.Nombre & "  " & piloto.apellido)
                    MessageBox.Show("Se ha añadido a la base de datos a la persona  " & Nombre)
                    ModoEditarAñadirPil(False)
                    CheckBoxAñadirTrabajo.Enabled = True
                Catch ex As Exception
                    MessageBox.Show(ex.Message, ex.Source)
                End Try

            End If

            If (Me.estadoPiloto = 1) Then
                Dim id As Integer
                id = piloto.idPersona
                Try
                    piloto = New Piloto(Nombre, fechaNacimiento, id, paisNacimiento)
                    piloto.idPersona = id
                    Dim actualizar As Integer
                    actualizar = piloto.modificar()
                    If (actualizar = 1) Then
                        MessageBox.Show("Error. No se pudo modificar ")
                    Else
                        MessageBox.Show("Persona modificada con exito ")

                    End If
                    Dim indice As Integer
                    indice = ListBoxPilotos.SelectedIndex
                    ListBoxPilotos.Items.RemoveAt(indice)
                    ListBoxPilotos.Items.Insert(indice, piloto.idPersona & "  " & piloto.Nombre & " " & piloto.apellido)

                Catch ex As Exception
                    MessageBox.Show(ex.Message, ex.Source)
                End Try
            End If

            ListBoxCircuitos.SelectedItem = Nothing
            ModoEditarAñadirPil(False)
            'estadoCheckAñadir = -1'
        End If



    End Sub

    Private Sub BtLimpiarPer_Click(sender As Object, e As EventArgs) Handles BtLimpiarPiloto.Click
        LimpiarFormEditarPil()
    End Sub

    Private Sub BtCancelarPer_Click(sender As Object, e As EventArgs) Handles BtCancelarPiloto.Click
        Dim volver As Integer
        volver = MsgBox("¿Estas seguro de que desea volver? Se perderán los cambios no guardados.", vbYesNo + vbDefaultButton2, "Cerrar modo edición.")
        If (volver = vbYes) Then
            estadoPiloto = -1
            ModoEditarAñadirPil(False)
            LimpiarFormEditaCir()
            estadoPartiPeli = 0
            estadoPartiRol = 0
            estadoCheckAñadir = -1
            CheckBoxAñadirTrabajo.Checked = False
            CheckBoxAñadirTrabajo.Enabled = True
        Else
            CheckBoxAñadirTrabajo.Checked = False
            estadoCheckAñadir = 0
        End If

        If Not ListBoxPilotos.SelectedIndex = -1 Then
            ListBoxPilotos.SetSelected(ListBoxPilotos.SelectedIndex, False)
        End If
    End Sub

 

    Private Sub CheckBoxAñadirTrabajo_CheckedChanged(sender As Object, e As EventArgs) Handles CheckBoxAñadirTrabajo.CheckedChanged
        GBDatosLaborales.Visible = CheckBoxAñadirTrabajo.Checked

        ' ListBoxEditarParticipaciones.Items.Clear()
        If estadoCheckAñadir = 0 Then
            Dim pelicula As ClasificacionCarrera
            pelicula = New ClasificacionCarrera
            pelicula.leertodo()
            Dim roles As Roles
            roles = New Roles
            roles.leertodo()
            CBPeliculaAñadirParti.Items.Clear()
            CBoxRolAñadirParti.Items.Clear()

            For Each rol In roles.rolesDAO.listaRoles
                CBoxRolAñadirParti.Items.Add(rol.idRol & "  " & rol.descRol)
            Next

            For Each film In pelicula.peliculasDAO.listaPeliculas
                CBPeliculaAñadirParti.Items.Add(film.idPelicula & "   " & film.titulo)
            Next

            '  persona.leerParticipaciones()

            For Each parti In piloto.participaciones

                Dim split As String() = parti.ToString().Split(New [Char]() {" "c})
                Dim idPelicula As Integer
                Dim idRol As Integer
                idPelicula = CInt(split(0))
                idRol = CInt(split(1))

                Dim peliculaP As ClasificacionCarrera
                peliculaP = New ClasificacionCarrera
                Dim rolP As Roles
                rolP = New Roles

                peliculaP.idPelicula = idPelicula
                rolP.idRol = idRol
                peliculaP.leer()
                rolP.leer()

                ListBoxEditarParticipaciones.Items.Add(peliculaP.idPelicula & " " & peliculaP.titulo & " --- " & rolP.idRol & " " & rolP.descRol)

            Next
            estadoCheckAñadir = 1
        End If
    End Sub

    Private Sub BtElimPel_Click(sender As Object, e As EventArgs) Handles BtElimCir.Click
        Dim borrar As Integer
        borrar = MsgBox("¿Esta seguro de que desea borrar de la Base de Datos el circuito seleccionado?", +vbYesNo + vbDefaultButton2, "Eliminar Película.")
        If (borrar = vbYes) Then
            Me.circuito.BorrarCircuito()
            ListBoxCircuitos.Items.RemoveAt(ListBoxCircuitos.SelectedIndex)
            LimpiarFormEditaCir()
        End If


    End Sub

    Private Sub BtEliminarPer_Click(sender As Object, e As EventArgs) Handles BtEliminarPer.Click
        Dim borrar As Integer
        borrar = MsgBox("¿Esta seguro de que desea borrar de la Base de Datos el piloto seleccionado?", +vbYesNo + vbDefaultButton2, "Eliminar Persona.")
        If (borrar = vbYes) Then
            Me.piloto.BorrarPiloto()
            ListBoxPilotos.Items.RemoveAt(ListBoxPilotos.SelectedIndex)
        End If
    End Sub

    Private Sub BtBorrarPais_Click(sender As Object, e As EventArgs) Handles BtBorrarPais.Click
        Dim borrar As Integer
        borrar = MsgBox("¿Esta seguro de que desea eliminar el pais seleccionado? Se borrará de todos los pilotos, Grandes Premios y cirucitos que lo contengan", +vbYesNo + vbDefaultButton2, "Eliminar Persona.")
        If (borrar = vbYes) Then
            Me.pais.BorrarPais()
            ListBoxPaises.Items.RemoveAt(ListBoxPaises.SelectedIndex)
            TextBoxDescPais.Text = ""
        End If
    End Sub

    Private Sub BtBorrarRol_Click(sender As Object, e As EventArgs) Handles BtBorrarRol.Click

        Dim borrar As Integer
        borrar = MsgBox("¿Esta seguro de que desea eliminar el pais seleccionado? Se borrará de todas las personas que lo contengan", +vbYesNo + vbDefaultButton2, "Eliminar Persona.")
        If (borrar = vbYes) Then
            Me.rol.eliminar()
            ListBoxRoles.Items.RemoveAt(ListBoxRoles.SelectedIndex)
            TextBoxDescRol.Text = ""
        End If

    End Sub

    Private Sub BtEditarPais_Click(sender As Object, e As EventArgs) Handles BtEditarPais.Click
        TextBoxDescPais.Text = pais.Nombre
        GBEditarAñadirPais.Enabled = True
        BtAñadirPais.Enabled = False
        BtBorrarPais.Enabled = False
        BtEditarPais.Enabled = False
        Me.estadoPaises = 1

    End Sub

    Private Sub BtCancelarPais_Click(sender As Object, e As EventArgs) Handles BtCancelarPais.Click
        Me.estadoPaises = -1
        BtAñadirPais.Enabled = True
        BtBorrarPais.Enabled = True
        BtEditarPais.Enabled = True
        GBEditarAñadirPais.Enabled = False
    End Sub

    Private Sub BtGuardarGeneros_Click(sender As Object, e As EventArgs) Handles BtGuardarPais.Click

        If TextBoxDescPais.Text = "" Then
            MsgBox("Introduzca un nombre para el pais", vbExclamation)
        ElseIf Not (comprobarNombrePropio(TextBoxDescRol.Text)) Then
            MsgBox("Nombre no válido. Solo puede contener letras y espacios.", vbExclamation)

        Else
            Dim nombrePais As String
            Dim genero As Generos
            nombrePais = TextBoxDescPais.Text().Trim()
            nombrePais = nombrePais.Substring(0, 1).ToUpper + nombrePais.Substring(1, nombrePais.Length - 1).ToLower

            genero = New Generos(nombrePais)

            If Me.estadoPaises = 0 Then 'Añadir un nuevo género'
                genero.insertar()
                genero.leerID()
                ListBoxPaises.Items.Add(genero.idGenero & "  " & genero.descGenero)

            ElseIf Me.estadoPaises = 1 Then 'Editar un género ya existente'
                Dim indice As Integer
                Try
                    Dim actualizar As Integer
                    Me.generoEdi.descGenero = nombrePais
                    actualizar = generoEdi.modificar()
                    If (actualizar = 1) Then
                        MessageBox.Show("Error. No se pudo modificar ")
                    Else
                        MessageBox.Show("Pais modificada con exito ")
                        indice = ListBoxPaises.SelectedIndex
                        ListBoxPaises.Items.RemoveAt(indice)
                        ListBoxPaises.Items.Insert(indice, Me.generoEdi.idGenero & "  " & Me.generoEdi.descGenero)

                    End If
                Catch

                End Try
            End If

            GBEditarAñadirPais.Enabled = False
            BtAñadirPais.Enabled = True
            TextBoxDescPais.Text = ""
        End If

    End Sub

    Private Sub BtLimpiarPais_Click(sender As Object, e As EventArgs) Handles BtLimpiarPais.Click
        TextBoxDescPais.Text = ""
    End Sub

    Private Sub BtCancelarRoles_Click(sender As Object, e As EventArgs) Handles BtCancelarRoles.Click
        Me.estadoRoles = -1
        BtAñadirRol.Enabled = True
        BtBorrarRol.Enabled = True
        BtEditarConf.Enabled = True
        GBEditarRoles.Enabled = False
    End Sub

    Private Sub BtLimpiarRoles_Click_1(sender As Object, e As EventArgs) Handles BtLimpiarRoles.Click
        TextBoxDescRol.Text = ""
    End Sub

    Private Sub BtEditarRol_Click(sender As Object, e As EventArgs) Handles BtEditarConf.Click
        TextBoxDescRol.Text = rol.descRol
        GBEditarRoles.Enabled = True
        BtAñadirRol.Enabled = False
        BtBorrarRol.Enabled = False
        BtEditarConf.Enabled = False
        Me.estadoRoles = 1
    End Sub

    Private Sub BtGuardarRoles_Click(sender As Object, e As EventArgs) Handles BtGuardarRoles.Click
        If TextBoxDescRol.Text = "" Then
            MsgBox("Introduzca un nombre para el rol", vbExclamation)
        ElseIf Not (comprobarNombrePropio(TextBoxDescPais.Text)) Then
            MsgBox("Nombre no válido. Solo puede contener letras y espacios.", vbExclamation)

        Else

            Dim descRol As String
            Dim rol As Roles
            descRol = TextBoxDescRol.Text().Trim()
            descRol = descRol.Substring(0, 1).ToUpper + descRol.Substring(1, descRol.Length - 1).ToLower

            rol = New Roles(descRol)

            If Me.estadoRoles = 0 Then 'Añadir un nuevo género'
                rol.insertar()

                rol.leerID()

                ListBoxRoles.Items.Add(rol.idRol & "  " & rol.descRol)

            ElseIf Me.estadoRoles = 1 Then 'Editar un género ya existente'
                Dim indice As Integer
                Dim actualizar As Integer
                Me.roledi.descRol = descRol
                actualizar = roledi.modificar
                If (actualizar = 1) Then
                    MessageBox.Show("Error. No se pudo modificar ")
                Else
                    MessageBox.Show("Rol modificada con exito ")
                    indice = ListBoxRoles.SelectedIndex
                    ListBoxRoles.Items.RemoveAt(indice)
                    ListBoxRoles.Items.Add(roledi.idRol & "  " & roledi.descRol)
                End If

            End If

            GBEditarRoles.Enabled = False
            BtAñadirRol.Enabled = True
            TextBoxDescPais.Text = ""
        End If


    End Sub

    Private Sub BtAñadirGen_Click(sender As Object, e As EventArgs)
        'Dim borrar As Integer
        'borrar = MsgBox("¿Esta seguro de que desea añadir el genero? Se añadira directamente ", +vbYesNo + vbDefaultButton2, "Añadir genero a persona.")
        'If (borrar = vbYes) Then
        'pelicula.insertarGenero(genero)
        'ListBoxTodosGeneros.Items.RemoveAt(ListBoxTodosGeneros.SelectedIndex)
        'ListBoxGenerosAñadidos.Items.Add(genero.idGenero & "  " & genero.descGenero)
        'End If
        If (estadoAñadirGenero = 1) Then
            ListBoxTodosGeneros.Items.RemoveAt(ListBoxTodosGeneros.SelectedIndex)
            ListBoxGenerosAñadidos.Items.Add(generoTodo.idGenero & "  " & generoTodo.descGenero)
            estadoAñadirGenero = 0
        End If

    End Sub

    Private Sub BtEliminarGenero_Click(sender As Object, e As EventArgs)
        If (estadoEliminarGenero = 1) Then
            ListBoxGenerosAñadidos.Items.RemoveAt(ListBoxGenerosAñadidos.SelectedIndex)
            ListBoxTodosGeneros.Items.Add(generoPeli.idGenero & "  " & generoPeli.descGenero)
            estadoEliminarGenero = 0
        End If
    End Sub

    Private Sub ListBoxTodosGeneros_SelectedIndexChanged(sender As Object, e As EventArgs)
        If ListBoxTodosGeneros.SelectedItem IsNot Nothing Then
            Dim split As String() = ListBoxTodosGeneros.SelectedItem.ToString().Split(New [Char]() {" "c})
            Dim id As Integer
            id = CInt(split(0))

            Dim genero As Generos
            genero = New Generos

            genero.idGenero = id

            genero.leer()
            Me.generoTodo = genero
            estadoAñadirGenero = 1
        End If
    End Sub

    Private Sub eliminarGenerosRepetidos()
        Dim lista As Collection
        lista = New Collection

        For Each Item As Object In ListBoxTodosGeneros.Items
            For Each item2 As Object In ListBoxGenerosAñadidos.Items
                Dim split As String() = Item.ToString().Split(New [Char]() {" "c})
                Dim split2 As String() = item2.ToString().Split(New [Char]() {" "c})
                Dim idGeneroA As Integer
                Dim idGeneroT As Integer
                idGeneroT = CInt(split(0))
                idGeneroA = CInt(split2(0))

                If (idGeneroT = idGeneroA) Then
                    ' MessageBox.Show(idGeneroT & " -- " & idGeneroA)
                    '     ListBoxTodosGeneros.Items.Remove(Item)
                    lista.Add(Item)
                End If
            Next
        Next

        For Each item As Object In lista
            '   MessageBox.Show(item.ToString)
            ListBoxTodosGeneros.Items.Remove(item)
        Next
    End Sub

    Private Sub ListBoxGenerosAñadidos_SelectedIndexChanged(sender As Object, e As EventArgs)
        If ListBoxGenerosAñadidos.SelectedItem IsNot Nothing Then
            Dim split As String() = ListBoxGenerosAñadidos.SelectedItem.ToString().Split(New [Char]() {" "c})
            Dim id As Integer
            id = CInt(split(0))

            Dim genero As Generos
            genero = New Generos

            genero.idGenero = id

            genero.leer()
            Me.generoPeli = genero
            estadoEliminarGenero = 1
        End If
    End Sub

    Private Sub BtEliminarGenero_Click_1(sender As Object, e As EventArgs)
        If (estadoEliminarGenero = 1) Then
            ListBoxGenerosAñadidos.Items.RemoveAt(ListBoxGenerosAñadidos.SelectedIndex)
            ListBoxTodosGeneros.Items.Add(generoPeli.idGenero & "  " & generoPeli.descGenero)
            estadoEliminarGenero = 0
        End If
    End Sub

    Private Sub BtAñadirGen2_Click(sender As Object, e As EventArgs)
        If (estadoAñadirGenero = 1) Then
            ListBoxTodosGeneros.Items.RemoveAt(ListBoxTodosGeneros.SelectedIndex)
            ListBoxGenerosAñadidos.Items.Add(generoTodo.idGenero & "  " & generoTodo.descGenero)
            estadoAñadirGenero = 0
        End If
    End Sub


    Private Sub GBEditarAñadirPel_Enter(sender As Object, e As EventArgs) Handles GBEditarAñadirCircuito.Enter

    End Sub

    Private Sub ListBoxGenerosAñadidos_SelectedIndexChanged_1(sender As Object, e As EventArgs)
        If ListBoxGenerosAñadidos.SelectedItem IsNot Nothing Then
            Dim split As String() = ListBoxGenerosAñadidos.SelectedItem.ToString().Split(New [Char]() {" "c})
            Dim id As Integer
            id = CInt(split(0))

            Dim genero As Generos
            genero = New Generos

            genero.idGenero = id

            genero.leer()
            Me.generoPeli = genero
            estadoEliminarGenero = 1
        End If
    End Sub

    Private Sub ListBoxTodosGeneros_SelectedIndexChanged_1(sender As Object, e As EventArgs)

        If ListBoxTodosGeneros.SelectedItem IsNot Nothing Then
            Dim split As String() = ListBoxTodosGeneros.SelectedItem.ToString().Split(New [Char]() {" "c})
            Dim id As Integer
            id = CInt(split(0))

            Dim genero As Generos
            genero = New Generos

            genero.idGenero = id

            genero.leer()
            Me.generoTodo = genero
            estadoAñadirGenero = 1
        End If
    End Sub


    Private Sub CBPelicula_SelectedIndexChanged(sender As Object, e As EventArgs) Handles CBPeliculaAñadirParti.SelectedIndexChanged
        If CBPeliculaAñadirParti.SelectedItem IsNot Nothing Then
            Dim split As String() = CBPeliculaAñadirParti.SelectedItem.ToString().Split(New [Char]() {" "c})
            Dim id As Integer
            id = CInt(split(0))

            Dim pelicula As ClasificacionCarrera
            pelicula = New ClasificacionCarrera

            pelicula.idPelicula = id
            pelicula.leer()

            Me.peliculaParti = pelicula
            estadoPartiPeli = 1

        End If
    End Sub

    Private Sub ComboBox1_SelectedIndexChanged(sender As Object, e As EventArgs) Handles CBoxRolAñadirParti.SelectedIndexChanged
        If CBoxRolAñadirParti.SelectedItem IsNot Nothing Then
            Dim split As String() = CBoxRolAñadirParti.SelectedItem.ToString().Split(New [Char]() {" "c})
            Dim id As Integer
            id = CInt(split(0))

            Dim rol As Roles
            rol = New Roles

            rol.idRol = id
            rol.leer()

            Me.rolPart = rol
            estadoPartiRol = 1
        End If
    End Sub

    Private Sub Button2_Click(sender As Object, e As EventArgs) Handles BtEliminarTodasParti.Click
        piloto.borrarTodasParticipaciones()
        ListBoxEditarParticipaciones.Items.Clear()
    End Sub

    Private Sub Button3_Click(sender As Object, e As EventArgs) Handles BtEliminarPartiSeleccionada.Click
        piloto.borrarParticipacion(peliAñadida, rolAñadido)
        ListBoxEditarParticipaciones.Items.RemoveAt(ListBoxEditarParticipaciones.SelectedIndex)
    End Sub

    Private Sub ListBoxEditarParticipaciones_SelectedIndexChanged(sender As Object, e As EventArgs) Handles ListBoxEditarParticipaciones.SelectedIndexChanged
        If ListBoxEditarParticipaciones.SelectedItem IsNot Nothing Then
            BtEliminarPartiSeleccionada.Enabled = True
            BtEliminarTodasParti.Enabled = True

            Dim split As String() = ListBoxEditarParticipaciones.SelectedItem.ToString().Split(New [Char]() {" "c})

            Dim idPelicula As Integer
            idPelicula = CInt(split(0))
            Dim idRol As Integer
            Dim i As Integer
            i = 0

            For Each c In split
                i += 1
                If c = "--" Then
                    idRol = i
                End If
            Next



            peliAñadida = New ClasificacionCarrera
            rolAñadido = New Roles
            peliAñadida.idPelicula = idPelicula
            rolAñadido.idRol = idRol

        Else
            BtEliminarPartiSeleccionada.Enabled = False
            BtEliminarTodasParti.Enabled = True

        End If
    End Sub

End Class